\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage[a4paper, left=3cm, right=3cm, top=2.5cm, bottom=2.5cm]{geometry}
\usepackage{amsmath}
\usepackage{float}
\title{Optimizing Revenue from Products and Workers
\\ MMCS Assignment 2}
\author{Alexandros Zachakos \& Benjamin De Sousa}
\date{}

\begin{document}
\maketitle
\newpage
\section{Contents}
\subsection{Introduction..................................................................3}
\subsection{Modeling Approach.......................................................3}
\newpage
\section{Introduction}
This consulting report was produced on the request of Producti-Co. It aims to optimize the profits of the client in the coming time period. The primary factors for this are the sale volumes and the labour costs. The profit ratio can thus be optimised by maximising the first and minimising the second. There are also constraints that must be considered in the company policy and working regulations.
The client produces 7 products with varying sale prices and production time requirements, listed in the table below.
\\ \\
\begin{table}[h!]
\centering
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.05}
\begin{tabular}{@{}cccccccc@{}}
\toprule
\textbf{Product} & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\ \midrule
Sale Price (£) & 100 & 420 & 350 & 490 & 550 & 100 & 1115 \\
Production Time (hrs) & 1.0 & 2.0 & 2.7 & 2.4 & 4.5 & 0.7 & 9.5 \\ 
\bottomrule
\end{tabular}
\caption{Product Information}
\label{tab:products}
\end{table}
\\ \\
It must also be noted that products 2, 3, 4 and 7 have specific constraints timed to them. Product 2 sees a production time increase of 1 hour per unit when production volume surpasses 100 units. Products 3 and 4 lead to an additional 75 hours of production time when produced together. Finally, product 7 incurs a start up cost of £2000.
The last set of constraints that must be considered are related to worker regulations. All workers at Producti-Co must work for 5 consecutive days followed by a 2 day break. The scheduling system is in steady state. The client can schedule a maximum of 500 workers per day. Workers are also split between full time and part time employees. We assume that the total production hours is the hours spread over the entire week, while the part time work hours should not exceed the $25\%$ of the total ones. The information for these workers is listed in the table below.
\\ \\
\begin{table}[h!]
\centering
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.05}
\begin{tabular}{@{}lccc@{}}
\toprule
\textbf{Type} & \textbf{Hours/Day} & \textbf{Pay (£/hr)} & \textbf{Max \% of Total Hours} \\ \midrule
Full-Time & 8 & 80 & -- \\
Part-Time & 6 & 35 & 25 \\ 
\bottomrule
\end{tabular}
\caption{Worker Type Information}
\label{tab:workers}
\end{table}
\\ \\
Utilizing this data a model was constructed and then deployed using a FICO Xpress model in Mosel. The output from this will be used to conduct the analysis later in the report.

\section{Modeling Approach}
In order to model the aforementioned optimization problem, we assume that  \\
$i\in \{1,...,7\}=\{\text{shift starting in Monday},...,\text{shift starting in Sunday}\}$
\\
$j\in \{1,...,7\}=\{\text{Monday},...,\text{Sunday}\}$
\\
$k\in \{1,2\}\ \ \ \ = \{\text{Full time worker, Part time worker}\}$
\\
$n,m\in \{1,...,7\}=\{\text{Product 1},...,\text{Product 7}\}$
\\ \\
and we define the following parameters:
\\ 
$c_{k}=$ daily cost (salary) of a worker type $k$ \\
$s_{n}=$ sale price of 1 unit of product $n$ \\ 
$g_n=$ maximum units of product n we can produce, until the required production hours change  \\
$h_{n}=$ production hours required for 1 unit of product $n$, before reaching $g_n$ units\\
$\hat{h}_{n}=$ production hours required for 1 unit of product $n$, after reaching $g_n$ units\\
$a=[0,0,0,0,0,0,2000]:$ where $a_{n}$ represents the start-up cost for product $n$ \\
$b=[8,6]: $ where $b_{k}$ is the number of the working hours of worker type $k$ \\
$M=[4000,1366,1481,1666,888,5714,421]:$ where $M_{n}$ is the maximum number of units of product $n$ that we can make in a day. \\
\\
The values of $M_{n}$ were calculated by using this procedure: 
$$\text{Maximum total working hours in a day}=$$
$$=\text{(Maximum daily number of full time workers)$*$(working hours of full time worker)}=$$
$$=500*8=4000$$
If $g_nh_n \geq 4000$ then:
$$ M_{n} = \left\lfloor \frac{\text{Maximum total working hours in a day}}{\text{Total hours for the production of 1 unit of product } n}\right\rfloor=\left\lfloor\frac{4000}{h_{n}}\right\rfloor$$
If $g_nh_n < 4000$ then $M_n =\left\lfloor Q_n\right\rfloor$, where $Q$ satisfies the equation:
$$g_nh_n+(Q_n-g_n)\hat{h}_n=\text{Maximun total working hours in a day}=4000$$
\\ 
The definition of the following variables was essential as well: \\
$x_{ijk}=$ number of workers type $k$ having shift $i$ and working on day $j$ \\
$p_{jn}=$ units of product $n$ produced on day $j$ before reaching $g_n$ units \\
$\hat{p}_{jn}=$ units of product $n$ produced after the first $g_n$ units \\
$y_{jn} =
\begin{cases}
1, & \text{if product $n$ is produced on day $j$} \\
0, & \text{otherwise}
\end{cases} $ \\
$z_{jn} =
\begin{cases}
1, & \text{if we produce more than $g_n$ units of product n on day $j$} \\
0, & \text{otherwise}
\end{cases} $ \\
$v_{jnm} =
\begin{cases}
1, & \text{if we produce both product n and m on day $j$} \\
0, & \text{otherwise}
\end{cases} $ \\

Also, in order to take into account the fact that employees work for 5 consecutive days and then take a mandatory 2-day break, we construct a matrix A, where the rows and columns demonstrate the shifts of each worker and the days of the week respectively. It's elements indicate 1 when an employee with shift pattern $i$ is supposed to work on day $j$, and 0 otherwise. Similarly, we define another upper triangular matrix B, which demonstrates the extra work hours needed when we produce 2 distinct products in the same day. In particular, if we produce products $n$ and $m$, with $n\leq m$ then the element $B(n,m)$ of the matrix represents the extra work hours required. The matrices A and B corresponding to Producti-Co's scenario, are the following: \\
$$A=\left[ \begin{array}{ccccccc}
1 & 1 & 1 & 1 & 1 & 0 & 0 \\
0 & 1 & 1 & 1 & 1 & 1 & 0 \\
0 & 0 & 1 & 1 & 1 & 1 & 1 \\
1 & 0 & 0 & 1 & 1 & 1 & 1 \\
1 & 1 & 0 & 0 & 1 & 1 & 1 \\
1 & 1 & 1 & 0 & 0 & 1 & 1 \\
1 & 1 & 1 & 1 & 0 & 0 & 1
\end{array}\right] , \ \ \ 
B=\left[ \begin{array}{ccccccc}
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 75 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0
\end{array}\right]$$ 
Hence, in order to maximize the revenue we have the following objective \\ function: \\
$$max \ \sum_{j=1}^{7} \sum_{n=1}^{7}(p_{jn}+\hat{p}_{jn})s_{n}-\sum_{k=1}^{2}\sum_{i=1}^{7}\sum_{j=1}^{7}c_{k}x_{ijk}-\sum_{j=1}^{7}\sum_{n=1}^{7}a_{n}y_{jn}$$
Starting with the constraints, in order to ensure that people work for 5 consecutive days followed by a 2 day break, we have that:
$$x_{ijk}=\begin{cases}
x_{iik}, & \text{if $A(i,j)=1$} \\
0, & \text{if $A(i,j)=0$}
\end{cases} \ \ \ \ \ \ (1)$$
Obviously, neither the number of workers nor the units of products can be negative, so:
$$x_{ijk}, \ p_{jn}, \ \hat{p}_{jn} \geq 0 \ \ \ \ \ \ \ (2)$$
In addition, we want to deter the increase of $\hat{p}_{jn}$, if ${p}_{jn}$ hasn't reached the value of $g_n$ yet. Thus, from the definitions of the variables $y_{jn}$ and $z_{jn}$, we get that:
$$y_{jn}\leq p_{jn}+\hat{p}_{jn} \leq M_{n} y_{jn} \ \ \ \ \ (3)$$
$$g_nz_{jn} \leq p_{jn}\leq g_n-1+z_{jn} \ \ \ \ (4) $$ $$  \hat{p}_{jn}\leq(M_n-g_n)z_{jn} \ \ \ \ (5)$$

It is also worth noting that $v_{jnm}$ is dependent of $y_{jn}$ and $y_{jm}$, a relation which can be linearly described as:
$$v_{jnm} \leq y_{jn}, \ v_{jnm} \leq y_{jm} \ \ \text{and} \ \ v_{jnm} \geq y_{jn}+y_{jm}-1 \ \ \ \ (6)$$
and obviously from its definition: $v_{jnm}=v_{jmn} \ \ \ \ (7)$ \\ \\
Moreover, Producti-Co has stated that no more than 500 workers should be on duty every day, hence:
$$\sum_{i=1}^{7}\sum_{j=1}^{7}\sum_{k=1}^{2}x_{ijk} \leq 500 \ \ \ \ (8)$$
and out of these workers, the working hours of the part time ones should constitute at most 25\% of the total working hours in the week:
$$0.25\sum_{i=1}^{7}\sum_{j=1}^{7}\sum_{k=1}^{2}x_{ijk}b_k \geq \sum_{i=1}^{7}\sum_{j=1}^{7}x_{ij2}b_2 \ \ \ \ (9)$$
Lastly, to make the model work, we need to consider that in order to make the products, employees should work adequate hours for their creation, so the total daily work hours should be more than the daily hours required for the production, which gives us the last constraint of the problem:
$$\sum_{n=1}^7\sum_{m=1}^7B(n,m)v_{jnm}+\sum_{n=1}^{7}(p_{jn}h_n+\hat{p}_{jn}\hat{h}_n) \leq \sum_{i=1}^{7}\sum_{k=1}^{2}x_{ijk}b_k \ \ \ \ (10)$$
This last constraint constituted the reason of defining the matrix B to be upper triangular and not symmetrical, so that the sums don't count the same value twice. \\
\\
Now in case that we want to extend the model, and hypothesize that the productivity of each worker drops approximately $2\%$ every hour, then the average productivity of a full time worker would be:
$$\frac{100\%+98\%+96\%+94\%+92\%+90\%+88\%+86\%}{8}=93\%$$ 
of their initial one, while the respective percentage for a part time worker would be:
$$\frac{100\%+98\%+96\%+94\%+92\%+90\%}{6}=95\%$$
This would have adverse effects on the production, as a worker would need slightly more time in order to create each product, changing the constraints $(3),(5)\text{ and }(10)$ as follows:
$$y_{jn}\leq p_{jn}+\hat{p}_{jn} \leq M_{n}T_1 y_{jn} \ \ \ \ \ (3/\text{extension})$$
$$  \hat{p}_{jn}\leq(M_nT_1-g_n)z_{jn} \ \ \ \ (5/\text{extension})$$
$$\sum_{n=1}^7\sum_{m=1}^7B(n,m)v_{jnm}+\sum_{n=1}^{7}(p_{jn}h_n+\hat{p}_{jn}\hat{h}_n) \leq \sum_{i=1}^{7}\sum_{k=1}^{2}x_{ijk}b_kT_k \ \ \ \ (10/\text{extension})$$
where $T=[0.93, \ 0.95]$ and $T_1$, $T_2$ define the productivity of a full or a part time worker respectively.

\section*{4 Analysis}

This analysis uses the output from the Mosel model. The code and data files are attached with the submission of this report. 

\medskip
The production data is displayed in Table~\ref{tab:production}.

\begin{table}[H]
\centering
\setlength{\tabcolsep}{4.5pt}
\renewcommand{\arraystretch}{1.05}
\begin{tabular}{@{}lrrrrrrrr@{}}
\toprule
\textbf{Product} & \textbf{Mon} & \textbf{Tue} & \textbf{Wed} & \textbf{Thu} & \textbf{Fri} & \textbf{Sat} & \textbf{Sun} & \textbf{Total} \\ \midrule
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
2 & 97 & 99 & 99 & 100 & 98 & 99 & 99 & 691 \\
3 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
4 & 1490 & 1405 & 1488 & 1500 & 1418 & 1405 & 1488 & 10194 \\
5 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
6 & 0 & 0 & 1 & 0 & 1 & 0 & 1 & 3 \\
7 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ \midrule
\textbf{Total} & 1587 & 1504 & 1588 & 1600 & 1517 & 1504 & 1588 & 10888 \\ 
\bottomrule
\end{tabular}
\caption{Production Data Generated by Model}
\label{tab:production}
\end{table}

\medskip
The total profit obtained from modelling this optimisation problem was £3{,}507{,}830. Considering the maximum possible revenue for a given material (i.e.\ £5{,}716{,}666 for product~4) and maximum possible labour cost (£2{,}240{,}000), this result is reasonable. As expected, based on the ratio of sale price to production time, the model suggests production should be almost entirely constituted of products~2 and~4. Product~4 is the most profitable, and even accounting for the stepwise increase in production hours, product~2 is a close second. 

Since there are no production limits, the model has no reason to consider the other products when optimising for profit. As anticipated, no units of product~7 appear, as despite its high sale price, its production-time ratio is poor and it incurs a start-up cost each day it is produced. This output aligns well with the intuitive interpretation of the raw data. 

The five units of product~6 likely fill minor schedule gaps due to its short production time. This implies that the model may use a form of best-fit sorting algorithm during its optimisation.

\medskip
Labour data are displayed in Table~\ref{tab:labour}.

\begin{table}[h!]
\centering
\setlength{\tabcolsep}{5pt}
\renewcommand{\arraystretch}{1.05}
\begin{tabular}{@{}lrrrrr@{}}
\toprule
\textbf{Day} & \textbf{Full-Time} & \textbf{Part-Time} & \textbf{Work Hours} & \textbf{Part-Time \%} & \textbf{Production Hours} \\ \midrule
Monday & 385 & 115 & 3770 & 18.30 & 3770 \\
Tuesday & 285 & 215 & 3570 & 36.13 & 3570 \\
Wednesday & 385 & 115 & 3770 & 18.30 & 3769.9 \\
Thursday & 400 & 100 & 3800 & 15.79 & 3800 \\
Friday & 300 & 200 & 3600 & 33.33 & 3599.9 \\
Saturday & 285 & 215 & 3570 & 36.13 & 3570 \\
Sunday & 385 & 115 & 3770 & 18.30 & 3769.9 \\ \midrule
\textbf{Total} & 2425 & 1075 & 25850 & 24.95 & 25849.7 \\ 
\bottomrule
\end{tabular}
\caption{Labour Data Generated by Model}
\label{tab:labour}
\end{table}

\medskip
As expected, the model utilised the maximum number of workers each day to maximise total production hours. If this were not the case, it would suggest that the product catalogue requires adjustment to improve profitability, most directly by increasing sale prices. The ratio of full-time to part-time workers varies day to day. As this ratio was constrained only on a weekly basis, this variation is reasonable. It likely helps maintain a consistent production output while maximising the number of part-time workers, who are significantly cheaper than full-time staff. 

This, however, causes daily production hours to vary between 3{,}570 and 3{,}800. While this variation should not cause major issues, future demand forecasting should account for it.

\medskip
A sensitivity analysis was also conducted. It was initially attempted directly through the Mosel model; however, as the model involves mixed-integer programming, it did not yield an optimal solution in a feasible timeframe—even with LP relaxation. This produced non-constant shadow prices, so a manual sensitivity analysis was performed instead. 

The two tested constraints were the daily worker limit and the maximum 25\% limit on part-time work hours. These were the binding constraints of the model; all others had slack. The worker constraint was tested by increasing the daily worker limit in steps of 10 up to 550.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{profit vs max workers.png}
    \caption{Graph 1: Relationship Between Profit and Maximum Workers}
    \label{fig:profit_workers}
\end{figure}

Relaxing the cap on the number of workers leads to a proportional increase in profit, as expected given there is no production limit. The client should consider lifting this cap if feasible.

The part-time constraint was tested by increasing the threshold in 5\% increments up to 50\%.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{part time workers.png}
    \caption{Graph 2: Effect of Variable Part-Time Worker Proportion on Profit}
    \label{fig:profit_workers}
\end{figure}

There is a clear upward trend in profit and a downward trend in cost-to-revenue ratio as the proportion of part-time work hours increases. The client should consider negotiating with the union to adjust their regulations accordingly.

\end{document}
